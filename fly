local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local flying = false
local speed = 29
local bodyGyro
local bodyVelocity

local function startFlying()
    flying = true
    humanoid.PlatformStand = true

    bodyGyro = Instance.new("BodyGyro")
    bodyGyro.P = 9e4
    bodyGyro.maxTorque = Vector3.new(9e9, 9e9, 9e9)
    bodyGyro.cframe = char.PrimaryPart.CFrame
    bodyGyro.Parent = char.PrimaryPart

    bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.velocity = Vector3.new(0, 0.1, 0)
    bodyVelocity.maxForce = Vector3.new(9e9, 9e9, 9e9)
    bodyVelocity.Parent = char.PrimaryPart

    while flying do
        local moveDirection = humanoid.MoveDirection
        bodyVelocity.velocity = (workspace.CurrentCamera.CFrame.lookVector * moveDirection.Z + workspace.CurrentCamera.CFrame.RightVector * moveDirection.X) * speed
        bodyGyro.cframe = workspace.CurrentCamera.CFrame
        game:GetService("RunService").RenderStepped:Wait()
    end
end

startFlying()